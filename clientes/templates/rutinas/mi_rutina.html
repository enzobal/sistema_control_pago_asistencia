{% extends 'base.html' %}

{% block content %}
<style>

body {
    background: url("/static/images/nemesis2.jpg") no-repeat center center fixed;
    background-size: cover;
    font-family: "Arial", sans-serif;
    color: #a81e1e;
}

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        background-color: #970909;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 10px;
        overflow: hidden;
    }

    th, td {
        border: 2px solid #007BFF;
        padding: 12px;
        text-align: center;
    }

    th {
        background-color: #007BFF;
        color: white;
        font-size: 16px;
    }

    td {
        background-color: #968f8f;
        font-size: 14px;
    }

    tr:nth-child(even) {
        background-color: #f2f2f2;
    }

    a {
        text-decoration: none;
        background-color: #28a745;
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-weight: bold;
    }

    a:hover {
        background-color: #218838;
    }

    img {
        border-radius: 8px;
        border: 2px solid #007BFF;
        cursor: pointer;
        transition: transform 0.2s;
        max-width: 150px;
    }

    img:hover {
        transform: scale(1.1);
    }

    h2 {
        text-align: center;
        color: #1a0801;
        font-size: 24px;
    }

    iframe, video {
        width: 200px;
        height: 120px;
        border-radius: 8px;
        border: 2px solid #007BFF;
    }
</style>

<h2>Mi Rutina</h2>

{% if rutinas %}
    <table>
        <tr>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Descargar Descripción</th>
            <th>Imagen</th>
            <th>Descargar Imagen</th>
            <th>Video</th>
            <th>Ver Video</th>
        </tr>
        {% for rutina in rutinas %}
            <tr>
                <td>{{ rutina.nombre }}</td>
                <td>{{ rutina.descripcion }}</td>
                <td>
                    {% if rutina.descripcion %}
                        <a href="data:text/plain;charset=utf-8,{{ rutina.descripcion|urlencode }}"
                            download="{{ rutina.nombre }}_descripcion.txt">Descargar</a>
                    {% else %}
                        No disponible
                    {% endif %}
                </td>
                <td>
                    {% if rutina.imagen %}
                        <img src="{{ rutina.imagen.url }}" alt="Imagen de rutina" width="100">
                    {% else %}
                        No hay imagen
                    {% endif %}
                </td>
                <td>
                    {% if rutina.imagen %}
                        <a href="{{ rutina.imagen.url }}" download="{{ rutina.nombre }}_imagen.jpg">Descargar</a>
                    {% else %}
                        No disponible
                    {% endif %}
                </td>
                <td>
                    {% if rutina.video_url %}
                        {% if 'youtube.com' in rutina.video_url or 'youtu.be' in rutina.video_url %}
                            <!-- Extraer ID del video correctamente -->
                            {% with rutina.video_url|slice:"-11:" as video_id %}
                                <iframe 
                                    width="200" height="120"
                                    src="https://www.youtube.com/embed/{{ video_id }}?rel=0" 
                                    allowfullscreen>
                                </iframe>
                            {% endwith %}
                        {% else %}
                            <!-- Video subido manualmente -->
                            <video controls width="200">
                                <source src="{{ rutina.video_url }}" type="video/mp4">
                                Tu navegador no soporta el video.
                            </video>
                        {% endif %}
                    {% else %}
                        No disponible
                    {% endif %}
                </td>
                <td>
                    {% if rutina.video_url %}
                        <a href="{{ rutina.video_url }}" target="_blank">Ver Video</a>
                    {% else %}
                        No disponible
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>
{% else %}
    <p style="text-align: center; font-size: 18px; color: #555;">No tienes ninguna rutina asignada.</p>
{% endif %}

{% endblock %}